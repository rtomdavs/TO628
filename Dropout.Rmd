---
title: "College Dropout Prediction"
author: "The Kumar Kids"
output:
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
    theme: spacelab
    highlight: zenburn
date: "2023-04-13"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Initial Model Building and Testing

## Reading and Cleaning
```{r}
#Reading in the dataset
drops <- read.csv("dataset.csv")

#Converting our target variable into a factor to check the levels
drops$Target <- as.factor(drops$Target)
summary(drops)

#Removing the enrolled students, for later prediction
nonenr <- subset(drops, drops$Target != "Enrolled")

#Switching target variable to 1 or 0
nonenr$Target <- ifelse(nonenr$Target == "Dropout", 1, 0)
```

# Initial Loading and Logistic Regression
## Testing and Training Sets
```{r}
set.seed(12345)
trainrows <- sample(nrow(nonenr), 0.8*nrow(nonenr))

droptrain <- nonenr[trainrows, ]
droptest <- nonenr[-trainrows, ]
```

## Building Logistic Model
```{r}
logmod <- lm(Target ~., data = droptrain)
```

## Testing Logistic Model
```{r}
library(caret)

Logpred <- predict(logmod, droptest)
pblog <- ifelse(Logpred >= 0.5, 1, 0)
confusionMatrix(as.factor(pblog), as.factor(droptest$Target), positive = "1")
```

# Creating KNN model